(function(e){function t(t){for(var o,i,s=t[0],n=t[1],u=t[2],m=0,d=[];m<s.length;m++)i=s[m],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);c&&c(t);while(d.length)d.shift()();return l.push.apply(l,u||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],o=!0,s=1;s<a.length;s++){var n=a[s];0!==r[n]&&(o=!1)}o&&(l.splice(t--,1),e=i(i.s=a[0]))}return e}var o={},r={app:0},l=[];function i(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=o,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(a,o,function(t){return e[t]}.bind(null,o));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],n=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var c=n;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";a("85ec")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("d3b7");var o=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("router-view")},l=[],i={name:"app",provide:function(){return{reload:this.reload}},data:function(){return{isRouterAlive:!0}},methods:{reload:function(){this.isRouterAlive=!1,this.$nextTick((function(){this.isRouterAlive=!0}))}}},s=i,n=(a("034f"),a("2877")),u=Object(n["a"])(s,r,l,!1,null,null,null),c=u.exports,m=a("8c4f"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-wrap"},[a("div",{staticClass:"main"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[a("h3",[e._v("后台用户注册")]),a("el-divider"),a("el-form-item",{attrs:{label:"用户名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",e._n(t))},expression:"ruleForm.name"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"pass"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码",autocomplete:"off"},model:{value:e.ruleForm.pass,callback:function(t){e.$set(e.ruleForm,"pass",t)},expression:"ruleForm.pass"}})],1),a("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[a("el-input",{attrs:{type:"password",placeholder:"请再次输入密码",autocomplete:"off"},model:{value:e.ruleForm.checkPass,callback:function(t){e.$set(e.ruleForm,"checkPass",t)},expression:"ruleForm.checkPass"}})],1),a("router-link",{staticStyle:{float:"right"},attrs:{to:"/sign_in"}},[e._v("注册完成，点我登录")]),a("br"),a("el-form-item",[a("el-button",{attrs:{type:"success",icon:"el-icon-magic-stick"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("注 册")])],1)],1)],1)])},p=[],f=(a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")}),h=[],_=a("5c96"),b=a.n(_),v={name:"Global",methods:{successOpen:function(e){Object(_["Message"])({message:e,type:"success"})},failOpen:function(e){_["Message"].error(e)}}},g=v,x=Object(n["a"])(g,f,h,!1,null,"14790b76",null),w=x.exports,$={data:function(){var e=this,t=function(t,a,o){""===a?o(new Error("请再次输入密码")):a!==e.ruleForm.pass?o(new Error("两次输入密码不一致!")):o()};return{ruleForm:{pass:"",checkPass:"",name:""},rules:{pass:[{required:!0,pattern:"^[A-Za-z0-9]{6,12}$",message:"密码需要长度6-12的数字或英文字符",trigger:"blur"}],checkPass:[{validator:t,trigger:"blur"}],name:[{required:!0,pattern:"^[A-Za-z]{5,10}$",message:"用户名只能是长度5-10的英文字符",trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.handleSignup()}))},handleSignup:function(){this.$axios.post("/user/sign_up",{username:this.ruleForm.name,password:this.ruleForm.pass}).then((function(e){200===e.data.code&&w.methods.successOpen("注册成功")})).catch((function(e){w.methods.failOpen(e.response.data.msg.detail)}))}}},k=$,y=(a("d88c"),Object(n["a"])(k,d,p,!1,null,"22609809",null)),F=y.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-wrap"},[a("div",{staticClass:"main"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[a("h3",[e._v("后台用户登录")]),a("el-divider"),a("el-form-item",{attrs:{label:"用户名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",e._n(t))},expression:"ruleForm.name"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"pass"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码",autocomplete:"off"},model:{value:e.ruleForm.pass,callback:function(t){e.$set(e.ruleForm,"pass",t)},expression:"ruleForm.pass"}})],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-user-solid"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("登 录")])],1)],1)])},L=[],S=(a("ac1f"),a("5319"),{data:function(){return{ruleForm:{pass:"",name:""},rules:{pass:[{required:!0,message:"用户名不能为空",trigger:"blur"}],name:[{required:!0,message:"用户名不能为空",trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.handleLogin()}))},handleLogin:function(){var e=this;this.$axios.post("/user/sign_in",{username:this.ruleForm.name,password:this.ruleForm.pass}).then((function(t){200===t.status&&(w.methods.successOpen("登录成功"),localStorage.setItem("token",t.data.msg.token),localStorage.setItem("username",e.ruleForm.name),e.$router.replace({path:"/rule"}))})).catch((function(e){console.log(e),w.methods.failOpen(e.response.data.msg.detail)}))}}}),W=S,I=(a("f514"),Object(n["a"])(W,O,L,!1,null,"01a29b74",null)),j=I.exports,P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Head"),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{fixed:"",prop:"id",label:"规则ID",width:"50"}}),a("el-table-column",{attrs:{prop:"app_id",label:"app的唯一标识",width:"80"}}),a("el-table-column",{attrs:{prop:"platform",label:"平台",width:"100"}}),a("el-table-column",{attrs:{prop:"download_url",label:"下载链接",width:"200"}}),a("el-table-column",{attrs:{prop:"update_version_code",label:"包的当前版本",width:"150"}}),a("el-table-column",{attrs:{prop:"md5",label:"包的MD5",width:"80"}}),a("el-table-column",{attrs:{prop:"max_update_version_code",label:"可升级的最大版本",width:"100"}}),a("el-table-column",{attrs:{prop:"min_update_version_code",label:"可升级的最小版本",width:"100"}}),a("el-table-column",{attrs:{prop:"max_os_api",label:"支持的最大操作系统版本",width:"80"}}),a("el-table-column",{attrs:{prop:"min_os_api",label:"支持的最小操作系统版本",width:"80"}}),a("el-table-column",{attrs:{prop:"cpu_arch",label:"CPU架构",width:"50"}}),a("el-table-column",{attrs:{prop:"channel_number",label:"渠道号",width:"150"}}),a("el-table-column",{attrs:{prop:"title",label:"弹窗标题",width:"120"}}),a("el-table-column",{attrs:{prop:"update_tips",label:"弹窗的更新文本",width:"120"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.delRule(t.row)}}},[e._v("删除")])]}}])})],1),a("el-row",{staticStyle:{float:"right"},attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添 加 规 则")])],1)],1),a("el-dialog",{attrs:{title:"更新规则",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"app的唯一标识","label-width":e.formLabelWidth,prop:"app_id"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.app_id,callback:function(t){e.$set(e.form,"app_id",t)},expression:"form.app_id"}})],1),a("el-form-item",{attrs:{label:"平台","label-width":e.formLabelWidth,prop:"platform"}},[a("el-input",{attrs:{placeholder:"IOS/Android",autocomplete:"off"},model:{value:e.form.platform,callback:function(t){e.$set(e.form,"platform",t)},expression:"form.platform"}})],1),a("el-form-item",{attrs:{label:"下载链接","label-width":e.formLabelWidth,prop:"download_url"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.download_url,callback:function(t){e.$set(e.form,"download_url",t)},expression:"form.download_url"}})],1),a("el-form-item",{attrs:{label:"包的当前版本","label-width":e.formLabelWidth,prop:"update_version_code"}},[a("el-input",{attrs:{placeholder:"如8.1.3.01",autocomplete:"off"},model:{value:e.form.update_version_code,callback:function(t){e.$set(e.form,"update_version_code",t)},expression:"form.update_version_code"}})],1),a("el-form-item",{attrs:{label:"包的MD5","label-width":e.formLabelWidth,prop:"md5"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.md5,callback:function(t){e.$set(e.form,"md5",t)},expression:"form.md5"}})],1),a("el-form-item",{attrs:{label:"可升级的最大版本","label-width":e.formLabelWidth,prop:"max_update_version_code"}},[a("el-input",{attrs:{placeholder:"如8.1.3.01",autocomplete:"off"},model:{value:e.form.max_update_version_code,callback:function(t){e.$set(e.form,"max_update_version_code",t)},expression:"form.max_update_version_code"}})],1),a("el-form-item",{attrs:{label:"可升级的最小版本","label-width":e.formLabelWidth,prop:"min_update_version_code"}},[a("el-input",{attrs:{placeholder:"如8.1.3.01",autocomplete:"off"},model:{value:e.form.min_update_version_code,callback:function(t){e.$set(e.form,"min_update_version_code",t)},expression:"form.min_update_version_code"}})],1),a("el-form-item",{attrs:{label:"支持的最大操作系统版本","label-width":e.formLabelWidth,prop:"max_os_api"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.max_os_api,callback:function(t){e.$set(e.form,"max_os_api",t)},expression:"form.max_os_api"}})],1),a("el-form-item",{attrs:{label:"支持的最小操作系统版本","label-width":e.formLabelWidth,prop:"min_os_api"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.min_os_api,callback:function(t){e.$set(e.form,"min_os_api",t)},expression:"form.min_os_api"}})],1),a("el-form-item",{attrs:{label:"CPU架构","label-width":e.formLabelWidth,prop:"cpu_arch"}},[a("el-input",{attrs:{placeholder:"32/64",autocomplete:"off"},model:{value:e.form.cpu_arch,callback:function(t){e.$set(e.form,"cpu_arch",t)},expression:"form.cpu_arch"}})],1),a("el-form-item",{attrs:{label:"渠道号","label-width":e.formLabelWidth,prop:"channel_number"}},[a("el-input",{attrs:{placeholder:"如xiaomi,huawei等",autocomplete:"off"},model:{value:e.form.channel_number,callback:function(t){e.$set(e.form,"channel_number",t)},expression:"form.channel_number"}})],1),a("el-form-item",{attrs:{label:"弹窗标题","label-width":e.formLabelWidth,prop:"title"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"弹窗的更新文本","label-width":e.formLabelWidth,prop:"update_tips"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.update_tips,callback:function(t){e.$set(e.form,"update_tips",t)},expression:"form.update_tips"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addRule}},[e._v("确 定")])],1)],1)],1)],1)},R=[],D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"30%"}},[a("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal","text-color":"#000000","active-text-color":"#000000"},on:{select:e.handleSelect}},[a("el-menu-item",{attrs:{index:"1"}},[e._v("添加新版本规则")]),a("el-menu-item",{attrs:{index:"2"}},[e._v("添加规则白名单")]),a("el-submenu",{staticStyle:{float:"right"},attrs:{index:"3"}},[a("template",{slot:"title"},[e._v(e._s(e.username))]),a("el-menu-item",{attrs:{index:"1"}},[e._v("注册账户")]),a("el-menu-item",{attrs:{index:"2"}},[e._v("退出登录")])],2)],1)],1)},V=[],C={name:"Head",data:function(){return{username:localStorage.getItem("username"),activeIndex:"3"}},methods:{handleSelect:function(e,t){switch(t[0]){case"3":"1"===t[1]?this.$router.push("/sign_up"):(localStorage.removeItem("token"),this.$router.push("/sign_in"));break;case"2":this.$router.push("/whitelist");break;default:this.$router.push("/rule")}}}},E=C,q=(a("e8b4"),Object(n["a"])(E,D,V,!1,null,null,null)),M=q.exports,A={name:"Main",components:{Head:M},methods:{delRule:function(e){var t=this;this.$axios.delete("/rule?rule_id="+e.id).then((function(e){200===e.status&&(w.methods.successOpen("删除成功"),t.getRule())})).catch((function(e){w.methods.failOpen(e.response.data.msg.detail)}))},getRule:function(){var e=this;this.$axios.get("/rule/all").then((function(t){200===t.status&&(e.tableData=t.data.msg.data)})).catch((function(e){w.methods.failOpen(e.response.data.msg.detail)}))},addRule:function(){var e=this;this.$axios.post("/rule/new",{app_id:parseInt(this.form.app_id),platform:this.form.platform,download_url:this.form.download_url,update_version_code:this.form.update_version_code,md5:this.form.md5,max_update_version_code:this.form.max_update_version_code,min_update_version_code:this.form.min_update_version_code,max_os_api:parseInt(this.form.max_os_api),min_os_api:parseInt(this.form.min_os_api),cpu_arch:parseInt(this.form.cpu_arch),channel_number:this.form.channel_number,title:this.form.title,update_tips:this.form.update_tips}).then((function(t){200===t.status&&(e.getRule(),e.dialogFormVisible=!1,w.methods.successOpen("添加成功"))})).catch((function(e){w.methods.failOpen(e.response.data.msg.detail)}))}},mounted:function(){this.getRule()},data:function(){return{tableData:[],dialogFormVisible:!1,form:{app_id:"",platform:"",download_url:"",update_version_code:"",md5:"",max_update_version_code:"",min_update_version_code:"",max_os_api:"",min_os_api:"",cpu_arch:"",channel_number:"",title:"",update_tips:""},rules:{app_id:[{required:!0,message:"输入只能是数字串",pattern:"[0-9]+$",trigger:"blur"}],min_os_api:[{required:!0,message:"输入的只能是数字",pattern:"[0-9]+$",trigger:"blur"}],max_os_api:[{required:!0,message:"输入的只能是数字",pattern:"[0-9]+$",trigger:"blur"}],cpu_arch:[{required:!0,message:"输入的只能是数字",pattern:"[0-9]+$",trigger:"blur"}]},formLabelWidth:"200px"}}},z=A,H=Object(n["a"])(z,P,R,!1,null,null,null),T=H.exports,U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"text-align":"center"}},[e._v(" 访问界面无效,请重试...... ")])},J=[],Z={name:"NotFound"},B=Z,G=Object(n["a"])(B,U,J,!1,null,"28fce746",null),N=G.exports,K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Head"),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{fixed:"",prop:"rule_id",label:"规则ID",width:"700"}}),a("el-table-column",{attrs:{fixed:"",prop:"device_id",label:"设备ID",width:"700"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.delWhiteList(t.row)}}},[e._v("删除")])]}}])})],1),a("el-row",{staticStyle:{float:"right"},attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添 加 白 名 单")])],1)],1),a("el-dialog",{attrs:{title:"新增白名单",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"规则的ID","label-width":e.formLabelWidth,prop:"rule_id"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.rule_id,callback:function(t){e.$set(e.form,"rule_id",t)},expression:"form.rule_id"}})],1),a("el-form-item",{attrs:{label:"设备的ID","label-width":e.formLabelWidth,prop:"device_id"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.device_id,callback:function(t){e.$set(e.form,"device_id",t)},expression:"form.device_id"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addWhiteList}},[e._v("确 定")])],1)],1)],1)],1)},Q=[],X={name:"rule",components:{Head:M},data:function(){return{dialogFormVisible:!1,tableData:[],form:{rule_id:"",device_id:""},formLabelWidth:"200px",rules:{rule_id:[{required:!0,message:"输入只能是正整数",pattern:"^[1-9][0-9]*$",trigger:"blur"}]}}},methods:{addWhiteList:function(){var e=this;this.$axios.post("/rule/whitelist/new",{rule_id:parseInt(this.form.rule_id),device_id:this.form.device_id}).then((function(t){200===t.status&&(e.getWhiteList(),e.dialogFormVisible=!1,w.methods.successOpen("添加白名单成功"))})).catch((function(e){w.methods.failOpen(e.response.data.msg.detail)}))},delWhiteList:function(e){var t=this;console.log(e),this.$axios.delete("/rule/whitelist?rule_id="+e.rule_id+"&device_id="+e.device_id).then((function(e){200===e.status&&(w.methods.successOpen("删除成功"),t.getWhiteList())})).catch((function(e){w.methods.failOpen(e.response.data.msg.detail)}))},getWhiteList:function(){var e=this;this.$axios.get("/rule/whitelist/all").then((function(t){e.tableData=t.data.msg.data})).catch((function(e){w.methods.failOpen(e.response.data.msg.detail)}))}},mounted:function(){this.getWhiteList()}},Y=X,ee=Object(n["a"])(Y,K,Q,!1,null,"52c79cf8",null),te=ee.exports;o["default"].use(m["a"]);var ae=[{path:"/sign_up",name:"Registry",component:F},{path:"/sign_in",name:"Login",component:j},{path:"/rule",name:"Rule",component:T},{path:"/whitelist",name:"WhiteList",component:te},{path:"*",name:"error",component:N}],oe=new m["a"]({mode:"history",base:"/",routes:ae});oe.beforeEach((function(e,t,a){if("/sign_in"===e.path)a();else{var o=localStorage.getItem("token");o?a():a("/sign_in")}}));var re=oe,le=a("2f62");o["default"].use(le["a"]);var ie=new le["a"].Store({state:{},mutations:{},actions:{},modules:{}});a("0fae");o["default"].config.productionTip=!1,o["default"].use(b.a);var se=a("bc3a");se.defaults.baseURL="http://localhost:9090/api",o["default"].prototype.$axios=se,o["default"].prototype.$message=_["Message"],new o["default"]({router:re,store:ie,render:function(e){return e(c)}}).$mount("#app"),se.interceptors.request.use((function(e){return localStorage.getItem("token")&&(e.headers.Authorization="Bearer "+localStorage.getItem("token")),e}),(function(e){return Promise.reject(e)}))},"6f71":function(e,t,a){},"817b":function(e,t,a){},"85ec":function(e,t,a){},d88c:function(e,t,a){"use strict";a("6f71")},e8b4:function(e,t,a){"use strict";a("ee03")},ee03:function(e,t,a){},f514:function(e,t,a){"use strict";a("817b")}});
//# sourceMappingURL=app.43e3f9f3.js.map